<div class="product__subs__wrap {% if product.selected_or_first_available_variant.selling_plan_allocations.size > 0 %} active {% endif %}"
  {% if animations_enabled %}
    data-aos="hero"
    data-aos-anchor="{{ animation_anchor }}"
    data-aos-order="{{ animation_order }}"
  {% endif %}>


  <div class='subscription-title'>
    {{ 'products.product.subscription_header' | t }}
  </div>

  <fieldset class="product__subs" data-subscription-selectors>
    {% comment %} The input with name="selling_plan" submits to cart
      <input type="hidden" name="selling_plan" value="{{ product.selected_selling_plan.id }}" />
    {% endcomment %}
    <legend class="visually-hidden">{{ 'products.product.subscription' | t }}</legend>

    {% unless product.requires_selling_plan %}
      <div class="product__subs__group">
        <label class="product__subs__option">
          <input
            type="radio"
            name="selling-plan-group"
            value=""
            data-toggles-group
            {% unless product.selected_selling_plan %}
              checked
            {% endunless %}
            class='one-time-purchase'
            />
          <span>{{ 'products.product.one_time_purchase' | t }}</span>
        </label>
      </div>
    {% endunless %}


    {% for selling_plan_group in product.selling_plan_groups %}
      <div class="product__subs__group">
        <label class="product__subs__option">
          <input type="radio"
            data-toggles-group
            name="selling-plan-group"
            value="{{ selling_plan_group.id }}"
            {% if selling_plan_group.selling_plan_selected %}
              checked
            {% endif %}/>
          <span>{{ 'products.product.subscription_frequency_title' | t }}</span>
        </label>

        <div class="product__subs__plans{% unless selling_plan_group.selling_plan_selected %} hidden{% endunless %}" data-group-toggle="{{ selling_plan_group.id }}">

          <div class="product__subs__plans-inner-wrapper">
            <div class='subscription-selector-line'>
              <span class='frequency-variant-selector'>{{ 'products.product.subscription_frequency_select_title' | t }}</span>


              {% assign sorted_plans = selling_plan_group.selling_plans | sort: "name" %}
              <select name="selling_plan_fake">

                {% assign last_plan = sorted_plans | last %}
                <option value="{{ last_plan.id }}" {% if last_plan.selected %} selected="selected" {% endif %}>{{ last_plan.name }}</option>

                {% for plan in sorted_plans %}
                  {% unless forloop.last %}
                    <option value="{{ plan.id }}" {% if plan.selected %} selected="selected" {% endif %}>{{ plan.name }}</option>
                  {% endunless %}
                {% endfor %}
              </select>


              <div style="display:none" class='actual-select'>
                {% for plan in selling_plan_group.selling_plans %}
                  <input type="radio"
                  name="selling_plan"
                  value="{{ plan.id }}"
                  {% if plan.selected %}
                    checked
                  {% endif %}/>
                {% endfor %}
              </div>

            </div>

            {% if subscription_info != blank %}
              <div class='subscription-additional-info'>
                {{ subscription_info }}
              </div>
            {% endif %}
          </div>

        </div>

      </div>
    {% endfor %}
  </fieldset>
  <p data-plan-description class="product__subs__description{% unless product.selected_selling_plan %} hidden{% endunless %}">
    {{ product.selected_selling_plan.description }}
  </p>
</div>
